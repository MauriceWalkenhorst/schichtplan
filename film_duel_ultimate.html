<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#0a0c0e">
    <title>Film Duel Ultimate | Alle Filme</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&family=Space+Grotesk:wght@500;600;700&display=swap" rel="stylesheet">
    <style>
        * { -webkit-tap-highlight-color: transparent; font-family: 'Plus Jakarta Sans', sans-serif; }
        .font-display { font-family: 'Space Grotesk', sans-serif; }
        
        .aurora {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            z-index: -1;
            background: 
                radial-gradient(ellipse 80% 50% at 20% 40%, rgba(234, 179, 8, 0.1), transparent),
                radial-gradient(ellipse 60% 40% at 80% 60%, rgba(239, 68, 68, 0.08), transparent),
                linear-gradient(180deg, #0a0c0e 0%, #14181c 100%);
        }
        
        .glass-card {
            background: linear-gradient(135deg, rgba(255,255,255,0.06) 0%, rgba(255,255,255,0.02) 100%);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.08);
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.3);
        }
        
        .film-card {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
        }
        .film-card:hover { transform: translateY(-8px) scale(1.02); box-shadow: 0 20px 40px rgba(0, 0, 0, 0.4); }
        .film-card:active { transform: translateY(-4px) scale(0.98); }
        
        .vs-badge { animation: pulse-vs 2s ease-in-out infinite; }
        @keyframes pulse-vs { 0%, 100% { transform: translate(-50%, -50%) scale(1); } 50% { transform: translate(-50%, -50%) scale(1.1); } }
        
        .progress-bar { transition: width 0.5s ease; }
        .rank-item { animation: slide-in 0.3s ease-out; }
        @keyframes slide-in { from { opacity: 0; transform: translateX(-20px); } to { opacity: 1; transform: translateX(0); } }
        .streak-flame { animation: flicker 1s ease-in-out infinite alternate; }
        @keyframes flicker { 0% { opacity: 1; transform: scale(1); } 100% { opacity: 0.8; transform: scale(1.1); } }
        
        [x-cloak] { display: none !important; }
    </style>
</head>
<body class="text-white antialiased overflow-x-hidden" x-data="filmDuel()" x-init="init()">
    
    <div class="aurora"></div>
    
    <!-- Toast -->
    <div x-show="toast.show" x-cloak x-transition class="fixed top-24 left-1/2 -translate-x-1/2 z-50 glass-card px-6 py-3 rounded-full flex items-center gap-2">
        <span x-text="toast.message" class="text-sm font-medium"></span>
    </div>
    
    <div class="min-h-screen px-4 py-6 pb-24 max-w-4xl mx-auto">
        
        <!-- Header -->
        <header class="mb-6">
            <div class="flex items-center justify-between">
                <div class="flex items-center gap-3">
                    <div class="w-12 h-12 rounded-2xl bg-gradient-to-br from-yellow-400 to-orange-500 flex items-center justify-center shadow-lg">
                        <span class="text-xl font-black text-white">VS</span>
                    </div>
                    <div>
                        <h1 class="font-display text-2xl font-bold tracking-tight">Film<span class="text-yellow-400">Duel</span></h1>
                        <p class="text-xs text-slate-400">Ultimate Edition - <span x-text="allFilms.length"></span> Filme</p>
                    </div>
                </div>
                
                <div class="flex items-center gap-3">
                    <div x-show="streak > 0" class="flex items-center gap-1 streak-flame">
                        <span class="text-xl">ðŸ”¥</span>
                        <span class="font-bold text-orange-400" x-text="streak"></span>
                    </div>
                    <div class="text-right">
                        <p class="text-xs text-slate-400">Duell</p>
                        <p class="font-display font-bold"><span x-text="comparisons"></span>/<span x-text="targetComparisons"></span></p>
                    </div>
                </div>
            </div>
            
            <div class="mt-4 h-2 bg-white/10 rounded-full overflow-hidden">
                <div class="progress-bar h-full bg-gradient-to-r from-yellow-400 via-orange-500 to-red-500 rounded-full"
                     :style="'width: ' + Math.min((comparisons / targetComparisons) * 100, 100) + '%'"></div>
            </div>
        </header>
        
        <!-- MODE: DUEL -->
        <div x-show="mode === 'duel'" x-cloak>
            <div class="text-center mb-4">
                <p class="text-slate-400 text-sm">Welcher Film ist besser?</p>
                <p class="text-xs text-slate-500 mt-1">Runde <span x-text="comparisons + 1"></span></p>
            </div>
            
            <div class="grid md:grid-cols-2 gap-4 md:gap-8 relative">
                <!-- VS Badge -->
                <div class="absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 z-10 w-16 h-16 rounded-full bg-gradient-to-br from-yellow-400 to-orange-500 flex items-center justify-center vs-badge shadow-xl shadow-orange-500/30 border-4 border-black">
                    <span class="font-black text-black text-xl">VS</span>
                </div>
                
                <!-- Film A -->
                <div @click="chooseFilm(currentPair[0])" class="film-card glass-card rounded-3xl overflow-hidden">
                    <div class="aspect-[2/3] relative">
                        <img :src="tmdbBase + currentPair[0]?.poster" 
                             @error="$event.target.src = 'https://via.placeholder.com/300x450/1c2228/9ab?text=?'"
                             class="w-full h-full object-cover" :alt="currentPair[0]?.title">
                        <div class="absolute inset-0 bg-gradient-to-t from-black/80 via-transparent to-transparent"></div>
                        <div class="absolute top-3 left-3 px-2 py-1 rounded-lg bg-black/60 text-xs font-medium" x-text="currentPair[0]?.year"></div>
                    </div>
                    <div class="p-4">
                        <h3 class="font-display text-xl font-bold mb-1 leading-tight" x-text="currentPair[0]?.title"></h3>
                        <p class="text-sm text-slate-400" x-text="currentPair[0]?.director"></p>
                    </div>
                </div>
                
                <!-- Film B -->
                <div @click="chooseFilm(currentPair[1])" class="film-card glass-card rounded-3xl overflow-hidden">
                    <div class="aspect-[2/3] relative">
                        <img :src="tmdbBase + currentPair[1]?.poster" 
                             @error="$event.target.src = 'https://via.placeholder.com/300x450/1c2228/9ab?text=?'"
                             class="w-full h-full object-cover" :alt="currentPair[1]?.title">
                        <div class="absolute inset-0 bg-gradient-to-t from-black/80 via-transparent to-transparent"></div>
                        <div class="absolute top-3 left-3 px-2 py-1 rounded-lg bg-black/60 text-xs font-medium" x-text="currentPair[1]?.year"></div>
                    </div>
                    <div class="p-4">
                        <h3 class="font-display text-xl font-bold mb-1 leading-tight" x-text="currentPair[1]?.title"></h3>
                        <p class="text-sm text-slate-400" x-text="currentPair[1]?.director"></p>
                    </div>
                </div>
            </div>
            
            <div class="text-center mt-6">
                <button @click="skipPair()" class="text-slate-500 hover:text-slate-300 text-sm flex items-center gap-1 mx-auto">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 5l7 7-7 7M5 5l7 7-7 7"/>
                    </svg>
                    Ãœberspringen
                </button>
            </div>
        </div>
        
        <!-- MODE: RESULTS -->
        <div x-show="mode === 'results'" x-cloak>
            <div class="text-center mb-6">
                <h2 class="font-display text-3xl font-bold mb-2">Deine Top-Filme! ðŸŽ‰</h2>
                <p class="text-slate-400">Basierend auf <span x-text="comparisons"></span> Entscheidungen aus <span x-text="allFilms.length"></span> Filmen</p>
            </div>
            
            <!-- Podium -->
            <div class="flex justify-center items-end gap-4 mb-8">
                <div x-show="rankings.length > 1" class="text-center">
                    <div class="glass-card rounded-2xl p-3 mb-2 w-24">
                        <img :src="tmdbBase + rankings[1]?.poster" class="w-full rounded-lg aspect-[2/3] object-cover">
                    </div>
                    <span class="text-2xl font-black text-slate-400">2</span>
                    <p class="text-xs truncate w-24" x-text="rankings[1]?.title"></p>
                </div>
                
                <div x-show="rankings.length > 0" class="text-center -mt-4">
                    <div class="text-4xl mb-2">ðŸ‘‘</div>
                    <div class="glass-card rounded-2xl p-4 mb-2 w-32 border-2 border-yellow-500/50 shadow-lg shadow-yellow-500/20">
                        <img :src="tmdbBase + rankings[0]?.poster" class="w-full rounded-lg aspect-[2/3] object-cover">
                    </div>
                    <span class="text-3xl font-black text-yellow-400">1</span>
                    <p class="text-sm font-bold truncate w-32" x-text="rankings[0]?.title"></p>
                </div>
                
                <div x-show="rankings.length > 2" class="text-center">
                    <div class="glass-card rounded-2xl p-3 mb-2 w-24">
                        <img :src="tmdbBase + rankings[2]?.poster" class="w-full rounded-lg aspect-[2/3] object-cover">
                    </div>
                    <span class="text-2xl font-black text-orange-600">3</span>
                    <p class="text-xs truncate w-24" x-text="rankings[2]?.title"></p>
                </div>
            </div>
            
            <!-- Top 10 List -->
            <div class="glass-card rounded-3xl p-4 mb-6">
                <h3 class="font-semibold mb-4 flex items-center gap-2">
                    <svg class="w-5 h-5 text-yellow-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"/>
                    </svg>
                    Top 10 Deiner Filme
                </h3>
                
                <div class="space-y-2">
                    <template x-for="(film, index) in rankings.slice(0, 10)" :key="film.id">
                        <div class="rank-item flex items-center gap-3 p-3 rounded-xl bg-white/5 hover:bg-white/10">
                            <span class="w-8 text-center font-display font-bold"
                                  :class="index === 0 ? 'text-yellow-400 text-xl' : index === 1 ? 'text-slate-400' : index === 2 ? 'text-orange-600' : 'text-slate-500'"
                                  x-text="index + 1"></span>
                            <img :src="tmdbBase + film.poster" class="w-12 h-16 rounded-lg object-cover">
                            <div class="flex-1 min-w-0">
                                <p class="font-medium truncate" x-text="film.title"></p>
                                <p class="text-xs text-slate-400" x-text="film.year + ' Â· ' + film.director"></p>
                            </div>
                            <div class="text-right">
                                <p class="font-bold text-sm" x-text="Math.round(film.score)"></p>
                                <p class="text-xs text-slate-500" x-text="film.wins + 'W/' + film.losses + 'L'"></p>
                            </div>
                        </div>
                    </template>
                </div>
            </div>
            
            <!-- Stats -->
            <div class="grid grid-cols-3 gap-4">
                <div class="glass-card rounded-2xl p-4 text-center">
                    <p class="text-2xl font-bold text-emerald-400" x-text="comparisons"></p>
                    <p class="text-xs text-slate-400">Duelle</p>
                </div>
                <div class="glass-card rounded-2xl p-4 text-center">
                    <p class="text-2xl font-bold text-blue-400" x-text="allFilms.length"></p>
                    <p class="text-xs text-slate-400">Filme im Pool</p>
                </div>
                <div class="glass-card rounded-2xl p-4 text-center">
                    <p class="text-2xl font-bold text-orange-400" x-text="Math.round((rankings[0]?.wins / (rankings[0]?.wins + rankings[0]?.losses || 1)) * 100) + '%'"></p>
                    <p class="text-xs text-slate-400">Siegrate #1</p>
                </div>
            </div>
            
            <div class="flex gap-4 mt-8">
                <button @click="shareResults()" class="flex-1 py-3 rounded-xl glass-card text-slate-300 hover:text-white font-medium flex items-center justify-center gap-2">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"/>
                    </svg>
                    Teilen
                </button>
                <button @click="restart()" class="flex-1 py-3 rounded-xl bg-gradient-to-r from-yellow-400 to-orange-500 text-black font-semibold hover:opacity-90">
                    Neue Runde
                </button>
            </div>
        </div>
        
    </div>
    
    <script>
        function filmDuel() {
            return {
                tmdbBase: 'https://image.tmdb.org/t/p/w500',
                mode: 'duel',
                comparisons: 0,
                targetComparisons: 20,
                streak: 0,
                
                // Ultimate Film Collection - 80 Filme
                allFilms: [
                    // ACTION
                    { id: 1, title: 'The Dark Knight', poster: '/qJ2tW6WMUDux911r6m7haRef0WH.jpg', year: '2008', director: 'Christopher Nolan' },
                    { id: 2, title: 'Inception', poster: '/9gk7adHYeDvHkCSEqAvQNLV5Uge.jpg', year: '2010', director: 'Christopher Nolan' },
                    { id: 3, title: 'The Matrix', poster: '/f89U3ADr1oiB1s9GkdPOEpXUk5H.jpg', year: '1999', director: 'The Wachowskis' },
                    { id: 4, title: 'Avengers: Endgame', poster: '/or06FN3Dka5tukK1e9sl16pB3iy.jpg', year: '2019', director: 'Russo Brothers' },
                    { id: 5, title: 'Gladiator', poster: '/ty8TscduvD8HjbsBUU7ypDttwz.jpg', year: '2000', director: 'Ridley Scott' },
                    { id: 6, title: 'Terminator 2', poster: '/weVXMD5QBGeQil4HEATZqAkXeEc.jpg', year: '1991', director: 'James Cameron' },
                    { id: 7, title: 'LOTR: Return of the King', poster: '/rCzpDGLbOoPwLjy3OAm5NUPOiCj.jpg', year: '2003', director: 'Peter Jackson' },
                    { id: 8, title: 'LOTR: Fellowship', poster: '/6oom5QYQ2yQTMJIbnvbkBL9cHo6.jpg', year: '2001', director: 'Peter Jackson' },
                    { id: 9, title: 'Empire Strikes Back', poster: '/7BuH8itoSrLExs2YZSsM01Qk2no.jpg', year: '1980', director: 'Irvin Kershner' },
                    { id: 10, title: 'Die Hard', poster: '/yFihWxQcmqcaBRrRM4NhnGzD0.jpg', year: '1988', director: 'John McTiernan' },
                    { id: 11, title: 'Mad Max: Fury Road', poster: '/8tZYtuWezp8JbcsvHYO0O46tFbo.jpg', year: '2015', director: 'George Miller' },
                    { id: 12, title: 'John Wick', poster: '/fZPSdJ8nS6zQ1Z9m8j5vQ0V5b7t.jpg', year: '2014', director: 'Chad Stahelski' },
                    { id: 13, title: 'Casino Royale', poster: '/zu9g7l77O69O72zdcln1X0Xg5.jpg', year: '2006', director: 'Martin Campbell' },
                    { id: 14, title: 'Kill Bill Vol. 1', poster: '/v7TaX8kXMXs5yFFGR41gu0vky4.jpg', year: '2003', director: 'Quentin Tarantino' },
                    { id: 15, title: 'The Bourne Ultimatum', poster: '/lJy9mXmMH5uDfz1gR1cN7J2T4e.jpg', year: '2007', director: 'Paul Greengrass' },
                    { id: 16, title: 'Raiders of the Lost Ark', poster: '/44sKf3x5n5v5n5v5n5v5n5v5n.jpg', year: '1981', director: 'Steven Spielberg' },
                    { id: 17, title: 'The Dark Knight Rises', poster: '/5n5v5n5v5n5v5n5v5n5v5n5v.jpg', year: '2012', director: 'Christopher Nolan' },
                    { id: 18, title: 'Mission: Impossible - Fallout', poster: '/5n5v5n5v5n5v5n5v5n5v5n5v.jpg', year: '2018', director: 'Christopher McQuarrie' },
                    { id: 19, title: 'Blade Runner 2049', poster: '/gajva2L0rPYkEWjzgFlBXCAVBE5.jpg', year: '2017', director: 'Denis Villeneuve' },
                    { id: 20, title: 'No Country for Old Men', poster: '/5n5v5n5v5n5v5n5v5n5v5n5v.jpg', year: '2007', director: 'Coen Brothers' },
                    
                    // SCIENCE FICTION
                    { id: 21, title: 'Interstellar', poster: '/gEU2QniL6E86tC9z1PaVwpf77R1.jpg', year: '2014', director: 'Christopher Nolan' },
                    { id: 22, title: '2001: A Space Odyssey', poster: '/90T7b2LIrL07ndYQZSmLvN5Z8x.jpg', year: '1968', director: 'Stanley Kubrick' },
                    { id: 23, title: 'The Terminator', poster: '/qvktm0BHcnm0ul38lIxNk0eNbG3.jpg', year: '1984', director: 'James Cameron' },
                    { id: 24, title: 'Back to the Future', poster: '/7lyBcpYB0Qt8gYhXYaEZUNlA3Vz.jpg', year: '1985', director: 'Robert Zemeckis' },
                    { id: 25, title: 'Alien', poster: '/vfrQk5IPloGg1v9Rzbh21Eg3HjF.jpg', year: '1979', director: 'Ridley Scott' },
                    { id: 26, title: 'Arrival', poster: '/x2FJsf1ElAgr63Y3YNBufw5OcGv.jpg', year: '2016', director: 'Denis Villeneuve' },
                    { id: 27, title: 'Ex Machina', poster: '/bQBhvO8z7u4T0p3l9n2k9v7zM0P.jpg', year: '2014', director: 'Alex Garland' },
                    { id: 28, title: 'Dune: Part One', poster: '/d5NXSklXo0qyIYkgV94XAgMIckC.jpg', year: '2021', director: 'Denis Villeneuve' },
                    { id: 29, title: 'Star Wars: A New Hope', poster: '/6xfj47mP0P1pQg6k5H5X3L7X6.jpg', year: '1977', director: 'George Lucas' },
                    { id: 30, title: 'Eternal Sunshine', poster: '/5MwkWH9tYHv3mV9OdYTMR5qreIz.jpg', year: '2004', director: 'Michel Gondry' },
                    { id: 31, title: 'Minority Report', poster: '/5n5v5n5v5n5v5n5v5n5v5n5v.jpg', year: '2002', director: 'Steven Spielberg' },
                    { id: 32, title: 'District 9', poster: '/5n5v5n5v5n5v5n5v5n5v5n5v.jpg', year: '2009', director: 'Neill Blomkamp' },
                    { id: 33, title: 'Looper', poster: '/sE5C8Y49x9F3y5m5z9m7N6N5N4.jpg', year: '2012', director: 'Rian Johnson' },
                    { id: 34, title: 'Gravity', poster: '/wnZ8Wz7G6m5y5m5z9m7N6N5N5.jpg', year: '2013', director: 'Alfonso CuarÃ³n' },
                    { id: 35, title: 'The Martian', poster: '/5n5v5n5v5n5v5n5v5n5v5n5v.jpg', year: '2015', director: 'Ridley Scott' },
                    
                    // DRAMA
                    { id: 36, title: 'The Shawshank Redemption', poster: '/q6y0Go1tsGEsmtFryDOJo3dEmqu.jpg', year: '1994', director: 'Frank Darabont' },
                    { id: 37, title: 'The Godfather', poster: '/3bhkrj58Vtu7enYsRolD1fZdja1.jpg', year: '1972', director: 'Francis Ford Coppola' },
                    { id: 38, title: 'The Godfather Part II', poster: '/hek3koDUyRQ8oEQO35X0r4n8.jpg', year: '1974', director: 'Francis Ford Coppola' },
                    { id: 39, title: 'Forrest Gump', poster: '/arw2vcBveWOVZr6pxd9XTd1TdQa.jpg', year: '1994', director: 'Robert Zemeckis' },
                    { id: 40, title: 'Fight Club', poster: '/pB8BM7pdSp6B6Ih7QZ4DrQ3PmZ5.jpg', year: '1999', director: 'David Fincher' },
                    { id: 41, title: 'Goodfellas', poster: '/aKuFiU82s5ISJpGM9rRa9PJj3ji.jpg', year: '1990', director: 'Martin Scorsese' },
                    { id: 42, title: 'The Green Mile', poster: '/velWPhVMQeQKcxggNEU8YmIo52R.jpg', year: '1999', director: 'Frank Darabont' },
                    { id: 43, title: 'Schindler\'s List', poster: '/sF1URmfVUq7nS9bG9l5v7Yv9E8.jpg', year: '1993', director: 'Steven Spielberg' },
                    { id: 44, title: 'Pulp Fiction', poster: '/d5iIlFn5s0ImszYzBPb8JPIfbXD.jpg', year: '1994', director: 'Quentin Tarantino' },
                    { id: 45, title: 'Parasite', poster: '/7IiTTgloJzvGI1TAYymCfbfl3vT.jpg', year: '2019', director: 'Bong Joon Ho' },
                    { id: 46, title: '12 Angry Men', poster: '/7sf9CgJz30aQb3b5E5l3v4n9.jpg', year: '1957', director: 'Sidney Lumet' },
                    { id: 47, title: 'One Flew Over the Cuckoo\'s Nest', poster: '/2Sns5oMb356JNdBHgBETjIpRYy9.jpg', year: '1975', director: 'MiloÅ¡ Forman' },
                    { id: 48, title: 'Whiplash', poster: '/lIv1QinR7jr4HKj8B4m8Q5X5.jpg', year: '2014', director: 'Damien Chazelle' },
                    { id: 49, title: 'The Departed', poster: '/nT97ifVT2J1L6hZ5b2Y5M5Y5.jpg', year: '2006', director: 'Martin Scorsese' },
                    { id: 50, title: 'American History X', poster: '/c2gsmSQ2CqvK9m5q4y5y5y5y5.jpg', year: '1998', director: 'Tony Kaye' },
                    { id: 51, title: 'Se7en', poster: '/6yoghty5z5z5z5z5z5z5z5z5.jpg', year: '1995', director: 'David Fincher' },
                    { id: 52, title: 'The Silence of the Lambs', poster: '/rplLJ2h5N5N5N5N5N5N5N5N5.jpg', year: '1991', director: 'Jonathan Demme' },
                    { id: 53, title: 'American Beauty', poster: '/5y5y5y5y5y5y5y5y5y5y5y5.jpg', year: '1999', director: 'Sam Mendes' },
                    { id: 54, title: 'The Usual Suspects', poster: '/jgJoRWltoS4nn5N5N5N5N5N5.jpg', year: '1995', director: 'Bryan Singer' },
                    { id: 55, title: 'LÃ©on: The Professional', poster: '/y5y5y5y5y5y5y5y5y5y5y5y5.jpg', year: '1994', director: 'Luc Besson' },
                    { id: 56, title: 'Saving Private Ryan', poster: '/5n5v5n5v5n5v5n5v5n5v5n5v.jpg', year: '1998', director: 'Steven Spielberg' },
                    { id: 57, title: 'Seven Samurai', poster: '/5n5v5n5v5n5v5n5v5n5v5n5v.jpg', year: '1954', director: 'Akira Kurosawa' },
                    { id: 58, title: 'Psycho', poster: '/5n5v5n5v5n5v5n5v5n5v5n5v.jpg', year: '1960', director: 'Alfred Hitchcock' },
                    { id: 59, title: 'Rear Window', poster: '/5n5v5n5v5n5v5n5v5n5v5n5v.jpg', year: '1954', director: 'Alfred Hitchcock' },
                    { id: 60, title: 'Casablanca', poster: '/5n5v5n5v5n5v5n5v5n5v5n5v.jpg', year: '1942', director: 'Michael Curtiz' },
                    
                    // ANIMATION
                    { id: 61, title: 'Spirited Away', poster: '/39wmItIWsg5sZMyRUKGk251ytnZ.jpg', year: '2001', director: 'Hayao Miyazaki' },
                    { id: 62, title: 'Spider-Verse', poster: '/iiZZdoQBEYBv6id8su7ImL0oCbD.jpg', year: '2018', director: 'Bob Persichetti' },
                    { id: 63, title: 'Coco', poster: '/gGEsBPAijhV3oiZdynm8Pzx5N7K.jpg', year: '2017', director: 'Lee Unkrich' },
                    { id: 64, title: 'Toy Story', poster: '/rhIRbceoE9lR4veEXuwCC2wARtH.jpg', year: '1995', director: 'John Lasseter' },
                    { id: 65, title: 'WALLÂ·E', poster: '/9il7qNbeYnPMYlutfG5Vq6G5E.jpg', year: '2008', director: 'Andrew Stanton' },
                    { id: 66, title: 'Inside Out', poster: '/2H1T3Q5Q5Q5Q5Q5Q5Q5Q5Q5Q.jpg', year: '2015', director: 'Pete Docter' },
                    { id: 67, title: 'Up', poster: '/nkp1jX4qQ5Q5Q5Q5Q5Q5Q5Q5.jpg', year: '2009', director: 'Pete Docter' },
                    { id: 68, title: 'The Lion King', poster: '/b0MxU37dNmMwK7E5Z6C0tI9E9.jpg', year: '1994', director: 'Roger Allers' },
                    { id: 69, title: 'Your Name.', poster: '/q719jXXEzOoYaps6babgKnONONX.jpg', year: '2016', director: 'Makoto Shinkai' },
                    { id: 70, title: 'Howl\'s Moving Castle', poster: '/TkTPEm4nz8z9r5Z5z5z5z5z5.jpg', year: '2004', director: 'Hayao Miyazaki' },
                    { id: 71, title: 'Princess Mononoke', poster: '/6E8iP1z5z5z5z5z5z5z5z5z5.jpg', year: '1997', director: 'Hayao Miyazaki' },
                    { id: 72, title: 'Finding Nemo', poster: '/eLMg8Jz5z5z5z5z5z5z5z5z5.jpg', year: '2003', director: 'Andrew Stanton' },
                    { id: 73, title: 'Toy Story 3', poster: '/6bD9x5z5z5z5z5z5z5z5z5z5.jpg', year: '2010', director: 'Lee Unkrich' },
                    { id: 74, title: 'Zootopia', poster: '/5z5z5z5z5z5z5z5z5z5z5z5z.jpg', year: '2016', director: 'Byron Howard' },
                    { id: 75, title: 'The Incredibles', poster: '/5z5z5z5z5z5z5z5z5z5z5z5z.jpg', year: '2004', director: 'Brad Bird' },
                    { id: 76, title: 'Monsters, Inc.', poster: '/5z5z5z5z5z5z5z5z5z5z5z5z.jpg', year: '2001', director: 'Pete Docter' },
                    { id: 77, title: 'Shrek', poster: '/5z5z5z5z5z5z5z5z5z5z5z5z.jpg', year: '2001', director: 'Andrew Adamson' },
                    { id: 78, title: 'Ratatouille', poster: '/5z5z5z5z5z5z5z5z5z5z5z5z.jpg', year: '2007', director: 'Brad Bird' },
                    { id: 79, title: 'Grave of the Fireflies', poster: '/5z5z5z5z5z5z5z5z5z5z5z5z.jpg', year: '1988', director: 'Isao Takahata' },
                    { id: 80, title: 'Klaus', poster: '/5z5z5z5z5z5z5z5z5z5z5z5z.jpg', year: '2019', director: 'Sergio Pablos' }
                ],
                
                films: [],
                currentPair: [],
                rankings: [],
                filmStats: {},
                usedPairs: new Set(),
                
                toast: { show: false, message: '' },
                
                init() {
                    this.films = [...this.allFilms];
                    this.resetDuel();
                    this.generatePair();
                },
                
                resetDuel() {
                    this.comparisons = 0;
                    this.streak = 0;
                    this.usedPairs.clear();
                    this.filmStats = {};
                    this.films.forEach(f => {
                        this.filmStats[f.id] = { wins: 0, losses: 0, score: 1000 };
                    });
                },
                
                generatePair() {
                    // Get films that haven't been compared much
                    const available = this.films.filter(f => {
                        const stats = this.filmStats[f.id];
                        return (stats.wins + stats.losses) < 5;
                    });
                    
                    if (available.length < 2) {
                        this.calculateRankings();
                        this.mode = 'results';
                        return;
                    }
                    
                    // Pick two with fewest comparisons
                    available.sort((a, b) => {
                        const totalA = this.filmStats[a.id].wins + this.filmStats[a.id].losses;
                        const totalB = this.filmStats[b.id].wins + this.filmStats[b.id].losses;
                        return totalA - totalB;
                    });
                    
                    let filmA = available[0];
                    let filmB = available[1];
                    
                    // Ensure not same pair
                    const pairKey = [filmA.id, filmB.id].sort().join('-');
                    if (this.usedPairs.has(pairKey)) {
                        for (let i = 2; i < available.length; i++) {
                            const newKey = [filmA.id, available[i].id].sort().join('-');
                            if (!this.usedPairs.has(newKey)) {
                                filmB = available[i];
                                break;
                            }
                        }
                    }
                    
                    if (filmA.id === filmB.id || !filmB) {
                        this.calculateRankings();
                        this.mode = 'results';
                        return;
                    }
                    
                    this.currentPair = [filmA, filmB];
                    this.usedPairs.add([filmA.id, filmB.id].sort().join('-'));
                },
                
                chooseFilm(winner) {
                    const loser = this.currentPair.find(f => f.id !== winner.id);
                    
                    this.filmStats[winner.id].wins++;
                    this.filmStats[loser.id].losses++;
                    
                    // ELO scoring
                    const expectedA = 1 / (1 + Math.pow(10, (this.filmStats[loser.id].score - this.filmStats[winner.id].score) / 400));
                    const k = 32;
                    this.filmStats[winner.id].score += k * (1 - expectedA);
                    this.filmStats[loser.id].score -= k * (1 - expectedA);
                    
                    this.comparisons++;
                    this.streak++;
                    
                    this.showToast(`${winner.title} gewinnt!`);
                    
                    setTimeout(() => {
                        if (this.comparisons >= this.targetComparisons) {
                            this.calculateRankings();
                            this.mode = 'results';
                        } else {
                            this.generatePair();
                        }
                    }, 600);
                },
                
                skipPair() {
                    this.streak = 0;
                    this.generatePair();
                },
                
                calculateRankings() {
                    this.rankings = Object.entries(this.filmStats)
                        .map(([id, stats]) => {
                            const film = this.allFilms.find(f => f.id === parseInt(id));
                            return { ...film, ...stats };
                        })
                        .sort((a, b) => b.score - a.score);
                },
                
                shareResults() {
                    const top3 = this.rankings.slice(0, 3).map(f => f.title).join(', ');
                    const text = `Meine Top 3 aus ${this.allFilms.length} Filmen: ${top3}`;
                    
                    if (navigator.share) {
                        navigator.share({ title: 'Meine Film-Rangliste', text });
                    } else {
                        navigator.clipboard.writeText(text);
                        this.showToast('Kopiert!');
                    }
                },
                
                restart() {
                    this.mode = 'duel';
                    this.resetDuel();
                    this.generatePair();
                },
                
                showToast(msg) {
                    this.toast = { show: true, message: msg };
                    setTimeout(() => this.toast.show = false, 1500);
                }
            }
        }
    </script>
</body>
</html>
